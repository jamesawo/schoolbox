<!DOCTYPE html>
<html lang="en"
      xmlns:layout="http://www.w3.org/1999/xhtml" layout:decorate="~{modules/backend/layouts/master}"
      xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <title> SPECIFIC FEE  SETUP  </title>
</head>
<body>
<div>
    <ul layout:fragment="breadcrumbs" class="breadcrumb" >
        <li class="breadcrumb-item"><a th:href="@{/SLMS/Dashboard}">DASHBOARD</a></li>
        <li class="breadcrumb-item"> SPECIFIC FEE  SETUP</li>
    </ul>
</div>

<div layout:fragment="content" >
    <div class="content-box">
        <div class="col-lg-11">
            <div class="element-wrapper">
                <h6 class="element-header text-uppercase"> SPECIFIC FEE SETUP </h6>
                <div class="element-box col-lg-10">
                    <div class="element-box-content container">

                        <form th:action="@{/SLMS/FeeManagement/SpecificFeeCreation/SearchParams}" th:object="${sFeeSearchParamDto}" autocomplete="off">

                            <div class="row">
                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Programme Category  </label>
                                    <select class="form-control"
                                            name="programmeCategory"
                                            th:with="el=${insStrFilterMap.get('programmeCategories')}">
                                        <option value="0">Select</option>
                                        <option th:each="data: ${el}"
                                                th:text="${data.description}"
                                                th:value="${data.id}"
                                                th:selected="${userSearchParams?.programmeCategory eq data.id}?true">Description</option>
                                    </select>
                                </div>

                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Programme Type </label>
                                    <select name="programmeType"
                                            class="form-control" th:with="el=${insStrFilterMap.get('programmeTypes')}">
                                        <option value="0">Select</option>
                                        <option th:each="data: ${el}"
                                                th:text="${data.description}"
                                                th:value="${data.id}" th:selected="${userSearchParams?.programmeType eq data.id}?true">Description</option>
                                    </select>
                                </div>

                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Session </label>
                                    <select name="session"
                                            class="form-control" th:with="el=${insStrFilterMap.get('sessions')}">
                                        <option value="0">Select</option>
                                        <option th:each="data: ${el}"
                                                th:text="${data.description}"
                                                th:value="${data.id}" th:selected="${userSearchParams?.session eq data.id}?true">Description</option>
                                    </select>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Level </label>
                                    <select name="level" class="form-control" th:with="el=${insStrFilterMap.get('levels')}">
                                        <option value="0">Select</option>
                                        <option th:each="data: ${el}"
                                                th:text="${data.description}"
                                                th:value="${data.id}" th:selected="${userSearchParams?.level eq data.id}?true">Description</option>
                                    </select>
                                </div>

                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Semester </label>
                                    <select name="semester" class="form-control" th:with="el=${insStrFilterMap.get('semesters')}">
                                        <option value="0">Select</option>
                                        <option th:each="data: ${el}"
                                                th:text="${data.description}"
                                                th:value="${data.id}" th:selected="${userSearchParams?.semester eq data.id}?true">Description</option>
                                    </select>
                                </div>
                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Status </label>
                                    <select name="status" class="form-control">
                                        <option value="">Select</option>
                                        <option value="true" th:selected="${userSearchParams?.status} == 'true' ? true">Active</option>
                                        <option value="false" th:selected="${userSearchParams?.status} == 'false' ? true">Inactive</option>

                                    </select>
                                </div>
                            </div>

                            <div class="row">
                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Fee Category </label>
                                    <select name="feeCategory" class="form-control" th:with="el=${feeCatFilterMap.get('feeCategories')}">
                                        <option value="0">Select</option>
                                        <option th:each="data: ${el}"
                                                th:selected="${userSearchParams?.feeCategory eq data.id}?true"
                                                th:text="${data.description}" th:value="${data.id}">Value</option>
                                    </select>
                                </div>

                                <div class="form-group col-sm-6 col-md-4 col-lg-4">
                                    <label> Institution Structure </label>
                                    <input type="text"
                                           th:value="${userSearchParams?.institutionStructure}"
                                           name="institutionStructure" id="txtInstitutionStructure"
                                           class="form-control" placeholder="Search... Institution Structure">
                                    <input type="hidden" name="institutionStructureValue" id="txtInstitutionStructureHidden" value="0">
                                </div>
                            </div>

                            <!-- page Size-->
                            <input type="hidden" id="pageSize" value="10" name="pageSize" th:value="${userSearchParams?.pageSize lt 1 ? 10 : userSearchParams?.pageSize  }">
                            <!-- page number-->
                            <input type="hidden" id="pageNumber" value="0" name="pageNumber" th:value="${userSearchParams?.pageNumber lt 1 ? 0 : userSearchParams?.pageNumber }">
                            <!-- report format  -->
                            <input type="hidden" name="reportFormat" id="reportFormat">


                            <div class="row">
                                <div class="col-auto form-group">
                                    <button class="btn btn-md btn-primary" >  <i class="fa fa-search-plus" aria-hidden="true"></i>  Search </button>
                                    <button class="btn btn-md btn-primary" type="reset" >  <i class="fa fa-close" aria-hidden="true"></i> Clear </button>
                                </div>

                            </div>

                        </form>

                    </div>

                </div>

                <div class="element-box col-lg-10">
                    <div class="element-box-content container">

                        <div class="row">

                            <div class="col-auto c-pad form-group">
                                <button class="btn btn-md btn-primary" id="btnAddSpecificFee">  <i class="fa fa-plus-square" aria-hidden="true"></i> Specific Fee </button>
                            </div>

                            <div class="col-auto c-pad form-group">
                                <button class="btn btn-md btn-primary" id="btnAddGlobalFee">  <i class="fa fa-plus-square" aria-hidden="true"></i> Global Fee </button>
                            </div>


                            <div class="col-auto  form-group c-pad">
                                <button class="btn btn-md btn-primary" >  <i class="fa fa-toggle-on" aria-hidden="true"></i> Activate  </button>
                                <button class="btn btn-md btn-primary" >  <i class="fa fa-toggle-off" aria-hidden="true"></i> Deactivate </button>
                            </div>

                            <div class="form-group btn-group col-auto c-pad">
                                <button type="button" class="btn btn-md btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Fee Type
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" href="#">GLOBAL</a>
                                    <a class="dropdown-item" href="#">GENERAL</a>
                                </div>
                            </div>

                            <div class="form-group btn-group col-auto c-pad" >
                                <button type="button" class="btn btn-md btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Export Data
                                </button>
                                <div class="dropdown-menu">
                                    <a class="dropdown-item" href="#">EXCEL</a>
                                    <a class="dropdown-item" href="#">PDF</a>
                                </div>
                            </div>

                        </div>

                        <div class="row table-responsive">
                            <div class="col-sm-12" style="overflow-x:auto;">
                                <table class="table table-striped table-bordered table-hover table-condensedtable">
                                    <thead>
                                    <tr class="text-left">
                                        <th scope="col-1"><input type="checkbox" id="chkStatusHeader"> </th>
                                        <th></th>
                                        <th scope="col"> PROGRAMME TYPE </th>
                                        <th scope="col-1"> SESSION </th>
                                        <th scope="col-1"> LEVEL </th>
                                        <th scope="col"> INSTITUTION STRUCTURE </th>
                                        <th scope="col"> SEMESTER </th>
                                        <th scope="col"> FEE CATEGORY </th>
                                        <th scope="col"> DEPENDENT FEE </th>
                                        <th scope="col"> AMOUNT (₦) </th>
                                        <th scope="col"> ITEM CODE </th>
                                        <th scope="col-1"> MERCHANT ID </th>
                                        <th scope="col"> DATE MODIFIED </th>
                                        <th scope="col"> FEE TYPE </th>
                                        <th scope="col"> STATUS</th>
                                    </tr>
                                    </thead>
                                    <tbody class="col-auto" th:if="${searchResult}">


                                    <tr th:if="${#arrays.isEmpty(searchResult.specificFeeDTOS)}">
                                        <th colspan="15" class="text-center"> No Record Found </th>
                                    </tr>

                                    <tr class="text-left" th:each="result : ${searchResult.specificFeeDTOS}">

                                        <td><input type="checkbox" th:value="${result.id}"></td>
                                        <td>
                                            <a class="btn btn-md btn-primary btnEdit" th:href="@{/SLMS/}">
                                                <i class="fa fa-edit" aria-hidden="true"></i>
                                            </a>
                                        </td>
                                        <td class="text-left" th:text="${result.programmeTypeDescription}">PROGRAMME TYPE</td>

                                        <td class="text-left" th:text="${result.sessionDescription}">2022/2023</td>

                                        <td class="text-left" th:class="${result.globalFeeBool == true}? 'text-center':'text-left'"
                                            th:text="${!result.globalFeeBool AND result.levelDescription == null} ? 'ALL': ${result.levelDescription}">Level</td>

                                        <td class="text-left" th:class="${!result.globalFeeBool and result.institutionStructureDescription == null}? 'text-center':'text-left'"
                                            th:text="${!result.globalFeeBool AND result.institutionStructureDescription == null} ? 'ALL': ${result.institutionStructureDescription}">Institution Structure</td>

                                        <td class="text-left" th:class="${!result.globalFeeBool and result.semesterDescription == null}? 'text-center':'text-left'"
                                            th:text="${!result.globalFeeBool and result.semesterDescription == null } ? 'ALL': ${result.semesterDescription}">FIRST SEMESTER</td>

                                        <td class="text-left" th:text="${result.feeCategoryDescription}">TECHNOLOGY FEE</td>

                                        <td class="text-center" th:text="${result.dependentFee != null } ? ${result.dependentFee} : '-' ">-</td>

                                        <td class="text-center" th:text="${result.amount}">AMOUNT</td>

                                        <td class="text-left" th:text="${result.itemCode}">ITEM CODE</td>

                                        <td class="text-center" th:text="${result.merchantId != null } ? ${result.merchantId} : '-' ">-</td>

                                        <td class="text-left" th:text="${result.dateModified}">DATE MODIFIED</td>

                                        <td class="text-left text-uppercase" th:text="${result.feeType}">TYPE</td>
                                        <td class="text-left"
                                            th:class="${result.status == true} ? 'text-success':'text-danger'"
                                            th:text="${result.status == true}? 'ACTIVE' : 'INACTIVE' ">Active</td>
                                    </tr>

                                    </tbody>

                                </table>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div layout:fragment="body_modal">

        <form th:action="@{/SLMS/FeeManagement/SpecificFeeCreation/Create}"  method="post" id="frmSpecificFeeSetup" th:object="${specificFeeDTO}">
            <div aria-hidden="true" aria-labelledby="myLargeModalLabel" id="createSpecificFeeModal" class="modal fade" role="dialog" tabindex="-1" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog modal-md">
                    <div class="modal-content">

                        <div class="modal-header">
                            <h5 class="modal-title">-</h5>
                            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span aria-hidden="true"> &times;</span></button>
                        </div>

                        <div class="modal-body">
                            <hr>
                            <h6 class="text-uppercase">SETUP DETAILS</h6>
                            <hr>
                            <div class="row">
                                <div class="form-group mt-lg col-lg-12" th:with="el=${insStrFilterMap.get('programmeCategories')}">
                                    <div th:replace="/modules/backend/views/InstitutionStructure/fragments/__ProgrammeTypeDropDown :: ProgrammeTypeDropDown(${el})"></div>
                                    <input type="hidden" name="programmeType" id="txtSpecificFeeProgrammeTypeValue">
                                </div>

                                <div class="form-group mt-lg col-lg-12">
                                    <div th:replace="/modules/backend/views/InstitutionStructure/fragments/__InstitutionStructureDropDown :: InstitutionStructureDropDown( ${categories}, ${instStrListByLeastHieCategory} )"></div>
                                    <input type="hidden" name="institutionStructureValue" id="txtSpecificFeeInstitutionStructureValue">
                                </div>

                                <div class="form-group mt-lg col-lg-12">
                                    <label>Fee Category</label>
                                    <select class="form-control validate"
                                            th:with="el=${feeCatFilterMap.get('feeCategories')}"
                                            th:field="*{feeCategory}" required>
                                        <option value="">Select</option>
                                        <option th:each="feeCategory : ${el}"
                                                th:value="${feeCategory.id}" th:text="${feeCategory.description}"/>
                                    </select>
                                </div>

                                <div class="form-group mt-lg col-lg-12">
                                    <label>Session</label>
                                    <select class="form-control validate"
                                            th:field="*{session}"
                                            th:with="el=${insStrFilterMap.get('sessions')}" required>
                                        <option value="">Select</option>
                                        <option th:each="insSession : ${el}"
                                                th:value="${insSession.id}" th:text="${insSession.description}"/>
                                    </select>

                                </div>

                                <div class="form-group mt-lg col-lg-12">
                                    <label>Level</label>
                                    <select class="form-control validate"
                                            th:with="el=${insStrFilterMap.get('levels')}"
                                            th:field="*{level}" required>
                                        <option value="">Select</option>
                                        <option th:each="level : ${el}"
                                                th:value="${level.id}" th:text="${level.description}"/>
                                    </select>
                                </div>

                                <div class="form-group mt-lg col-lg-12">
                                    <label>Semester</label>
                                    <select class="form-control validate"
                                            th:with="el=${insStrFilterMap.get('semesters')}"
                                            th:field="*{semester}" required>
                                        <option value="">Select</option>
                                        <option th:each="semester : ${el}"
                                                th:value="${semester.id}" th:text="${semester.description}"/>
                                    </select>
                                </div>


                                <div class="form-group mt-lg col-lg-12">
                                    <label>Item Code</label>
                                    <input type="text" class="form-control validate" th:field="*{itemCode}">
                                </div>

                            </div>

                            <hr>
                            <h6 class="text-uppercase">PAYMENT DETAILS</h6>
                            <hr>

                            <div class="row">
                                <div class="form-group mt-lg col-lg-12">
                                    <label>Amount</label>
                                    <input type="number" th:field="*{amount}" class="form-control validate" min="0">
                                </div>
                            </div>
                            <div class="row">
                                <div class="form-group mt-lg col-lg-12">
                                    <input type="checkbox" th:field="*{allowPartPayment}" id="chkSpAllowPart" class="chkAllowPartPayment">
                                    <label for="chkSpAllowPart">Allow Instalment Payment</label>
                                </div>
                                <div class="hide">
                                    <div class="form-group mt-lg col-lg-12">
                                        <label>First Installment </label>
                                        <input type="number" class="form-control" th:field="*{firstInstalment}">
                                    </div>
                                    <div class="form-group mt-lg col-lg-12">

                                        <label>Second Installment </label>
                                        <input type="number" class="form-control" th:field="*{secondInstalment}">
                                        <small class="text-center">
                                            First and Second Instalment Must Sum Up to Total Amount
                                        </small>
                                    </div>
                                </div>

                            </div>
                            <input type="hidden" name="command" value="General">

                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-dismiss="modal" type="button"> Close</button>
                            <button class="btn btn-primary" type="button" id="btnSaveSpecificFee"> Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>

        <form th:action="@{/SLMS/FeeManagement/SpecificFeeCreation/Create}"  method="post" id="frmGlobalFeeSetup" th:object="${specificFeeDTO}">
            <div aria-hidden="true" aria-labelledby="myLargeModalLabel" id="createGlobalFeeModal" class="modal fade" role="dialog" tabindex="-1" data-backdrop="static" data-keyboard="false">
                <div class="modal-dialog modal-md">
                    <div class="modal-content">

                        <div class="modal-header">
                            <h5 class="modal-title" >-</h5>
                            <button aria-label="Close" class="close" data-dismiss="modal" type="button"><span aria-hidden="true"> &times;</span></button>
                        </div>

                        <div class="modal-body">
                            <hr>
                            <h6 class="text-uppercase">SETUP DETAILS</h6>
                            <hr>
                            <div class="row">

                                <div class="form-group mt-lg col-lg-12">
                                    <label>Fee Category</label>
                                    <select class="form-control"
                                            th:with="el=${feeCatFilterMap.get('feeCategories')}"
                                            th:field="*{feeCategory}" required>
                                        <option value="">Select</option>
                                        <option th:each="feeCategory : ${el}"
                                                th:value="${feeCategory.id}" th:text="${feeCategory.description}"/>
                                    </select>
                                </div>

<!--                                <div class="form-group mt-lg col-lg-12">-->
<!--                                    <label>Dependent Fee </label>-->
<!--                                    <select class="form-control" th:field="*{dependentFee}" >-->
<!--                                        <option>Select</option>-->
<!--                                    </select>-->
<!--                                </div>-->


                                <div class="form-group mt-lg col-lg-12">
                                    <label>Session</label>
                                    <select class="form-control validate"
                                            th:field="*{session}"
                                            th:with="el=${insStrFilterMap.get('sessions')}" required>
                                        <option value="">Select</option>
                                        <option th:each="insSession : ${el}"
                                                th:value="${insSession.id}" th:text="${insSession.description}"/>
                                    </select>

                                </div>


                                <div class="form-group mt-lg col-lg-12">
                                    <div>
                                        <label class="text-uppercase">Programme Category</label>
                                        <select id="selProgrammeCategoryGlobalFee"
                                                class="form-control selProgrammeCategoryGlobalFee"
                                                th:with="el=${insStrFilterMap.get('programmeCategories')}">
                                            <option value="0">Select..</option>

                                            <option th:each="category : ${el}"
                                                    th:value="${category.id}" th:text="${category.description}"
                                                    th:attr="data-id=${category.id},data-description=${category.description}"/>

                                        </select>
                                    </div>
                                </div>

                                <div class="form-group mt-lg col-lg-12 divProgrammeTypeGlobal  hide" id="divProgrammeTypeGlobal">

                                    <label class="text-uppercase">Programme Types</label>
                                    <select name="" id="selPTypeGlobal" th:field="*{programmeType}" class="form-control selPTypeGlobal">
                                        <option value="0">Select..</option>
                                    </select>

                                </div>



                                <div class="form-group mt-lg col-lg-12">
                                    <label>Item Code</label>
                                    <input type="text" class="form-control" th:field="*{itemCode}">
                                    <input type="hidden" name="type" value="General">
                                </div>

                            </div>

                            <hr>
                            <h6 class="text-uppercase">PAYMENT DETAILS</h6>
                            <hr>

                            <div class="row">
                                <div class="form-group mt-lg col-lg-12">
                                    <label>Amount</label>
                                    <input type="number" th:field="*{amount}" class="form-control" min="0">
                                </div>
                                <input type="hidden" value="Global" name="command" id="command">

                            </div>
                            <div class="row">
                                <div class="form-group mt-lg col-lg-12">
                                    <input type="checkbox" th:field="*{allowPartPayment}" id="chkGlAllowPart" class="chkAllowPartPayment">
                                    <label for="chkGlAllowPart">Allow Instalment Payment</label>
                                </div>
                                <div class="hide">
                                    <div class="form-group mt-lg col-lg-12">
                                        <label>First Installment </label>
                                        <input type="number" class="form-control" th:field="*{firstInstalment}">
                                    </div>
                                    <div class="form-group mt-lg col-lg-12">

                                        <label>Second Installment </label>
                                        <input type="number" class="form-control" th:field="*{secondInstalment}">
                                        <small class="text-center">
                                            First and Second Instalment Must Sum Up to Total Amount
                                        </small>
                                    </div>
                                </div>

                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-secondary" data-dismiss="modal" type="button"> Close</button>
                            <button class="btn btn-primary" type="submit"> Save changes</button>
                        </div>
                    </div>
                </div>
            </div>
        </form>

    </div>
</div>

<div layout:fragment="body_custom_script">
    <script type="text/javascript" th:src="@{/assets/backend/custom/js/FeeManagement/SpecificFee.js}"></script>
    <script type="text/javascript" th:if="${message}" th:inline="javascript">PNotify.alert({text: /*[[${message}]]*/ 'Success', type: 'success'});</script>
    <script type="text/javascript" th:if="${error}" th:inline="javascript">PNotify.alert({text: /*[[${error}]]*/ '', type: 'notice'});</script>
</div>

</body>

</html>
